#! /bin/sh /usr/share/dpatch/dpatch-run
## CVE-2011-1755.dpatch by Nico Golde <nion@debian.org>
##
## All lines beginning with `## DP:' are a description of the patch.
## DP: disable entity expansian to prevent billion laughs attack

@DPATCH@
Author: Nico Golde <nion@debian.org> | quilt header -r CVE-2011-1755.patch
echo Description: disable entity expansian to prevent billion laughs attack
--- jabberd2.orig/sx/sx.c
+++ jabberd2/sx/sx.c
@@ -191,6 +191,7 @@ void _sx_reset(sx_t s) {
 
     /* massaged expat into shape */
     XML_SetUserData(s->expat, (void *) s);
+    XML_SetDefaultHandler(s->expat, NULL);
 
     s->env = temp.env;
     s->ip = temp.ip;
